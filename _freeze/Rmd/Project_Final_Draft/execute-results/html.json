{
  "hash": "52d02646e6ad6bb9f4f62ce1a61a9e13",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Project Final Draft\"\nauthor: \"Ting Huang\"\ndate: \"2022-12-13\"\noutput: html_document\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(survival)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'survival' was built under R version 4.3.3\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# define column names for easy indexing\nindex_names = c('unit_nr', 'time_cycles')\nsetting_names = c('altitude', 'mach', 'TRA')\nsensor_names = c()\nfor(i in 1:21) {\n  name <- paste0(\"s_\", i)\n  sensor_names[i] = name\n}\ncol_names = c(index_names,setting_names,sensor_names)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1 <- read.table(file = \"train_FD001.txt\", col.names = col_names)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(data1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    unit_nr        time_cycles       altitude              mach           \n Min.   :  1.00   Min.   :  1.0   Min.   :-8.70e-03   Min.   :-6.000e-04  \n 1st Qu.: 26.00   1st Qu.: 52.0   1st Qu.:-1.50e-03   1st Qu.:-2.000e-04  \n Median : 52.00   Median :104.0   Median : 0.00e+00   Median : 0.000e+00  \n Mean   : 51.51   Mean   :108.8   Mean   :-8.87e-06   Mean   : 2.351e-06  \n 3rd Qu.: 77.00   3rd Qu.:156.0   3rd Qu.: 1.50e-03   3rd Qu.: 3.000e-04  \n Max.   :100.00   Max.   :362.0   Max.   : 8.70e-03   Max.   : 6.000e-04  \n      TRA           s_1             s_2             s_3            s_4      \n Min.   :100   Min.   :518.7   Min.   :641.2   Min.   :1571   Min.   :1382  \n 1st Qu.:100   1st Qu.:518.7   1st Qu.:642.3   1st Qu.:1586   1st Qu.:1402  \n Median :100   Median :518.7   Median :642.6   Median :1590   Median :1408  \n Mean   :100   Mean   :518.7   Mean   :642.7   Mean   :1591   Mean   :1409  \n 3rd Qu.:100   3rd Qu.:518.7   3rd Qu.:643.0   3rd Qu.:1594   3rd Qu.:1415  \n Max.   :100   Max.   :518.7   Max.   :644.5   Max.   :1617   Max.   :1441  \n      s_5             s_6             s_7             s_8            s_9      \n Min.   :14.62   Min.   :21.60   Min.   :549.9   Min.   :2388   Min.   :9022  \n 1st Qu.:14.62   1st Qu.:21.61   1st Qu.:552.8   1st Qu.:2388   1st Qu.:9053  \n Median :14.62   Median :21.61   Median :553.4   Median :2388   Median :9061  \n Mean   :14.62   Mean   :21.61   Mean   :553.4   Mean   :2388   Mean   :9065  \n 3rd Qu.:14.62   3rd Qu.:21.61   3rd Qu.:554.0   3rd Qu.:2388   3rd Qu.:9069  \n Max.   :14.62   Max.   :21.61   Max.   :556.1   Max.   :2389   Max.   :9245  \n      s_10          s_11            s_12            s_13           s_14     \n Min.   :1.3   Min.   :46.85   Min.   :518.7   Min.   :2388   Min.   :8100  \n 1st Qu.:1.3   1st Qu.:47.35   1st Qu.:521.0   1st Qu.:2388   1st Qu.:8133  \n Median :1.3   Median :47.51   Median :521.5   Median :2388   Median :8141  \n Mean   :1.3   Mean   :47.54   Mean   :521.4   Mean   :2388   Mean   :8144  \n 3rd Qu.:1.3   3rd Qu.:47.70   3rd Qu.:522.0   3rd Qu.:2388   3rd Qu.:8148  \n Max.   :1.3   Max.   :48.53   Max.   :523.4   Max.   :2389   Max.   :8294  \n      s_15            s_16           s_17            s_18           s_19    \n Min.   :8.325   Min.   :0.03   Min.   :388.0   Min.   :2388   Min.   :100  \n 1st Qu.:8.415   1st Qu.:0.03   1st Qu.:392.0   1st Qu.:2388   1st Qu.:100  \n Median :8.439   Median :0.03   Median :393.0   Median :2388   Median :100  \n Mean   :8.442   Mean   :0.03   Mean   :393.2   Mean   :2388   Mean   :100  \n 3rd Qu.:8.466   3rd Qu.:0.03   3rd Qu.:394.0   3rd Qu.:2388   3rd Qu.:100  \n Max.   :8.585   Max.   :0.03   Max.   :400.0   Max.   :2388   Max.   :100  \n      s_20            s_21      \n Min.   :38.14   Min.   :22.89  \n 1st Qu.:38.70   1st Qu.:23.22  \n Median :38.83   Median :23.30  \n Mean   :38.82   Mean   :23.29  \n 3rd Qu.:38.95   3rd Qu.:23.37  \n Max.   :39.43   Max.   :23.62  \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1 <- data1%>% \n  group_by(unit_nr) %>% \n  mutate(max_cycle = max(time_cycles)) %>% \n  mutate(RUL = max_cycle-time_cycles)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1 %>% \n  group_by(unit_nr) %>% \n  summarise(r = max(RUL)) %>% \n  ggplot() +\n  geom_histogram(aes(x = r), bins = 15) +\n  labs(title = \"Number of Failures of Turbofan Jet Engines over Time\", x = \"Time Cycles\") + \n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Project_Final_Draft_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nt1 = apply(data1[,c('s_1','s_2','s_3','s_4','s_5','s_6','s_7','s_8','s_9','s_10','s_11','s_12','s_13','s_14','s_15','s_16','s_17','s_18','s_19','s_20','s_21')],2,sd)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntab1 = matrix(t1, ncol = 1, byrow = TRUE)\ncolnames(tab1) = \"SD\"\nrownames(tab1) = c('s_1','s_2','s_3','s_4','s_5','s_6','s_7','s_8','s_9','s_10','s_11','s_12','s_13','s_14','s_15','s_16','s_17','s_18','s_19','s_20','s_21')\ntab1 = as.table(tab1)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntab1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               SD\ns_1   0.000000000\ns_2   0.500053270\ns_3   6.131149520\ns_4   9.000604781\ns_5   0.000000000\ns_6   0.001388985\ns_7   0.885092258\ns_8   0.070985479\ns_9  22.082879525\ns_10  0.000000000\ns_11  0.267087399\ns_12  0.737553392\ns_13  0.071918916\ns_14 19.076175976\ns_15  0.037505038\ns_16  0.000000000\ns_17  1.548763025\ns_18  0.000000000\ns_19  0.000000000\ns_20  0.180746428\ns_21  0.108250875\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1 <- data1 %>% \n  mutate(breakdown = ifelse(time_cycles == max_cycle,\n                            yes = 1,\n                            no = 0))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1 <- data1 %>% \n  mutate(start = time_cycles-1)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_n <- data1 %>% \n  filter(breakdown == 1)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nKM1 = survfit(Surv(time_cycles)~1, data = data_n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(KM1, ylab = \"Survival Proportion\", xlab = \"Time Cycles\")\n```\n\n::: {.cell-output-display}\n![](Project_Final_Draft_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n\n### Time-Varying Stuff\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoxph(Surv(start, time_cycles, breakdown) ~ s_9, data = data1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\ncoxph(formula = Surv(start, time_cycles, breakdown) ~ s_9, data = data1)\n\n        coef exp(coef) se(coef)     z        p\ns_9 0.011925  1.011996 0.002384 5.002 5.67e-07\n\nLikelihood ratio test=22.01  on 1 df, p=2.707e-06\nn= 20631, number of events= 100 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncoxph(Surv(start, time_cycles, breakdown) ~ s_9 + s_9:time_cycles, data = data1)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in coxph(Surv(start, time_cycles, breakdown) ~ s_9 + s_9:time_cycles, :\na variable appears on both the left and right sides of the formula\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\ncoxph(formula = Surv(start, time_cycles, breakdown) ~ s_9 + s_9:time_cycles, \n    data = data1)\n\n                      coef  exp(coef)   se(coef)      z      p\ns_9             -2.026e-02  9.799e-01  1.758e-02 -1.152 0.2492\ns_9:time_cycles  1.554e-04  1.000e+00  8.413e-05  1.847 0.0647\n\nLikelihood ratio test=25.7  on 2 df, p=2.632e-06\nn= 20631, number of events= 100 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncoxph(Surv(start, time_cycles, breakdown) ~ s_14, data = data1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\ncoxph(formula = Surv(start, time_cycles, breakdown) ~ s_14, data = data1)\n\n         coef exp(coef) se(coef)     z        p\ns_14 0.011050  1.011112 0.002813 3.928 8.57e-05\n\nLikelihood ratio test=13.84  on 1 df, p=0.0001992\nn= 20631, number of events= 100 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncoxph(Surv(start, time_cycles, breakdown) ~ s_14 + s_14:time_cycles, data = data1)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in coxph(Surv(start, time_cycles, breakdown) ~ s_14 + s_14:time_cycles,\n: a variable appears on both the left and right sides of the formula\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\ncoxph(formula = Surv(start, time_cycles, breakdown) ~ s_14 + \n    s_14:time_cycles, data = data1)\n\n                       coef  exp(coef)   se(coef)      z      p\ns_14             -3.799e-02  9.627e-01  2.068e-02 -1.837 0.0663\ns_14:time_cycles  2.370e-04  1.000e+00  9.899e-05  2.394 0.0167\n\nLikelihood ratio test=20.14  on 2 df, p=4.228e-05\nn= 20631, number of events= 100 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncoxph(Surv(start, time_cycles, breakdown) ~ s_4, data = data1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\ncoxph(formula = Surv(start, time_cycles, breakdown) ~ s_4, data = data1)\n\n      coef exp(coef) se(coef)     z      p\ns_4 0.3188    1.3755   0.0241 13.23 <2e-16\n\nLikelihood ratio test=328.9  on 1 df, p=< 2.2e-16\nn= 20631, number of events= 100 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncoxph(Surv(start, time_cycles, breakdown) ~ s_4 + s_4:time_cycles, data = data1)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in coxph(Surv(start, time_cycles, breakdown) ~ s_4 + s_4:time_cycles, :\na variable appears on both the left and right sides of the formula\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in agreg.fit(X, Y, istrat, offset, init, control, weights = weights, :\nRan out of iterations and did not converge\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\ncoxph(formula = Surv(start, time_cycles, breakdown) ~ s_4 + s_4:time_cycles, \n    data = data1)\n\n                      coef  exp(coef)   se(coef)      z        p\ns_4              0.4838592  1.6223231  0.1216414  3.978 6.96e-05\ns_4:time_cycles -0.0008467  0.9991537  0.0005971 -1.418    0.156\n\nLikelihood ratio test=330.8  on 2 df, p=< 2.2e-16\nn= 20631, number of events= 100 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncoxph(Surv(start, time_cycles, breakdown) ~ s_3, data = data1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\ncoxph(formula = Surv(start, time_cycles, breakdown) ~ s_3, data = data1)\n\n       coef exp(coef) se(coef)     z      p\ns_3 0.23189   1.26099  0.02078 11.16 <2e-16\n\nLikelihood ratio test=146.6  on 1 df, p=< 2.2e-16\nn= 20631, number of events= 100 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncoxph(Surv(start, time_cycles, breakdown) ~ s_3 + s_3:time_cycles, data = data1)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in coxph(Surv(start, time_cycles, breakdown) ~ s_3 + s_3:time_cycles, :\na variable appears on both the left and right sides of the formula\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\ncoxph(formula = Surv(start, time_cycles, breakdown) ~ s_3 + s_3:time_cycles, \n    data = data1)\n\n                      coef  exp(coef)   se(coef)      z        p\ns_3              0.4215603  1.5243381  0.1093176  3.856 0.000115\ns_3:time_cycles -0.0009639  0.9990366  0.0005394 -1.787 0.073958\n\nLikelihood ratio test=149.6  on 2 df, p=< 2.2e-16\nn= 20631, number of events= 100 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncoxph(Surv(start, time_cycles, breakdown) ~ s_11, data = data1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\ncoxph(formula = Surv(start, time_cycles, breakdown) ~ s_11, data = data1)\n\n          coef exp(coef)  se(coef)     z      p\ns_11 9.726e+00 1.674e+04 7.478e-01 13.01 <2e-16\n\nLikelihood ratio test=298.1  on 1 df, p=< 2.2e-16\nn= 20631, number of events= 100 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncoxph(Surv(start, time_cycles, breakdown) ~ s_11 + s_11:time_cycles, data = data1)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in coxph(Surv(start, time_cycles, breakdown) ~ s_11 + s_11:time_cycles,\n: a variable appears on both the left and right sides of the formula\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\ncoxph(formula = Surv(start, time_cycles, breakdown) ~ s_11 + \n    s_11:time_cycles, data = data1)\n\n                       coef  exp(coef)   se(coef)     z        p\ns_11              1.741e+01  3.656e+07  3.827e+00  4.55 5.36e-06\ns_11:time_cycles -3.881e-02  9.619e-01  1.840e-02 -2.11   0.0349\n\nLikelihood ratio test=302.2  on 2 df, p=< 2.2e-16\nn= 20631, number of events= 100 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncoxph(Surv(start, time_cycles, breakdown) ~ s_17 + s_11 + s_4 + s_9 + s_3, data = data1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\ncoxph(formula = Surv(start, time_cycles, breakdown) ~ s_17 + \n    s_11 + s_4 + s_9 + s_3, data = data1)\n\n          coef exp(coef)  se(coef)     z        p\ns_17 5.157e-01 1.675e+00 1.264e-01 4.082 4.47e-05\ns_11 6.036e+00 4.182e+02 9.937e-01 6.074 1.25e-09\ns_4  2.257e-01 1.253e+00 2.970e-02 7.599 2.98e-14\ns_9  5.505e-04 1.001e+00 2.825e-03 0.195   0.8455\ns_3  4.884e-02 1.050e+00 2.867e-02 1.703   0.0885\n\nLikelihood ratio test=412.8  on 5 df, p=< 2.2e-16\nn= 20631, number of events= 100 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncoxph(Surv(start, time_cycles, breakdown) ~ s_3 + s_4 + s_9 + s_11, data = data1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\ncoxph(formula = Surv(start, time_cycles, breakdown) ~ s_3 + s_4 + \n    s_9 + s_11, data = data1)\n\n          coef exp(coef)  se(coef)     z        p\ns_3  5.713e-02 1.059e+00 2.847e-02 2.006   0.0448\ns_4  2.302e-01 1.259e+00 2.874e-02 8.011 1.14e-15\ns_9  5.227e-03 1.005e+00 2.588e-03 2.020   0.0434\ns_11 6.415e+00 6.109e+02 9.524e-01 6.735 1.64e-11\n\nLikelihood ratio test=395.3  on 4 df, p=< 2.2e-16\nn= 20631, number of events= 100 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntab2 = matrix(c(5.713e-02, 1.25855, 0.0448, 2.302e-01, 1.259e+00, 1.14e-15, 5.227e-03, 1.005e+00, 0.0434, 6.415e+00, 6.109e+02, 1.64e-11), ncol = 3, byrow = TRUE)\ncolnames(tab2) = c(\"coef\", \"exp(coef)\", \"p-value\")\nrownames(tab2) = c('Sensor 3','Sensor 4','Sensor 9','Sensor 11')\ntab2 = as.table(tab2)\ntab2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                 coef   exp(coef)     p-value\nSensor 3  5.71300e-02 1.25855e+00 4.48000e-02\nSensor 4  2.30200e-01 1.25900e+00 1.14000e-15\nSensor 9  5.22700e-03 1.00500e+00 4.34000e-02\nSensor 11 6.41500e+00 6.10900e+02 1.64000e-11\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntab3 = matrix(c(4.884e-02, 1.050e+00, 0.0885, 2.257e-01, 1.253e+00, 2.98e-14, 5.505e-04, 1.001e+00, 0.8455, 6.036e+00, 4.182e+02, 1.25e-09, 5.157e-01, 1.675e+00, 4.47e-05), ncol = 3, byrow = TRUE)\ncolnames(tab3) = c(\"coef\", \"exp(coef)\", \"p-value\")\nrownames(tab3) = c('Sensor 3','Sensor 4','Sensor 9','Sensor 11', 'Sensor 17')\ntab3 = as.table(tab3)\ntab3\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               coef exp(coef)   p-value\nSensor 3  4.884e-02 1.050e+00 8.850e-02\nSensor 4  2.257e-01 1.253e+00 2.980e-14\nSensor 9  5.505e-04 1.001e+00 8.455e-01\nSensor 11 6.036e+00 4.182e+02 1.250e-09\nSensor 17 5.157e-01 1.675e+00 4.470e-05\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1a = data1\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1a$s_9lag = c(NA, data1a$s_9[-nrow(data1a)])\ndata1a$s_9lag[which(!duplicated(data1a$unit_nr))] = NA\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1a\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 20,631 × 31\n# Groups:   unit_nr [100]\n   unit_nr time_cycles altitude   mach   TRA   s_1   s_2   s_3   s_4   s_5   s_6\n     <int>       <int>    <dbl>  <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>\n 1       1           1  -0.0007  -4e-4   100  519.  642. 1590. 1401.  14.6  21.6\n 2       1           2   0.0019  -3e-4   100  519.  642. 1592. 1403.  14.6  21.6\n 3       1           3  -0.0043   3e-4   100  519.  642. 1588. 1404.  14.6  21.6\n 4       1           4   0.0007   0      100  519.  642. 1583. 1402.  14.6  21.6\n 5       1           5  -0.0019  -2e-4   100  519.  642. 1583. 1406.  14.6  21.6\n 6       1           6  -0.0043  -1e-4   100  519.  642. 1584. 1398.  14.6  21.6\n 7       1           7   0.001    1e-4   100  519.  642. 1592. 1398.  14.6  21.6\n 8       1           8  -0.0034   3e-4   100  519.  643. 1583. 1401.  14.6  21.6\n 9       1           9   0.0008   1e-4   100  519.  642. 1591. 1395.  14.6  21.6\n10       1          10  -0.0033   1e-4   100  519.  642. 1591. 1400.  14.6  21.6\n# ℹ 20,621 more rows\n# ℹ 20 more variables: s_7 <dbl>, s_8 <dbl>, s_9 <dbl>, s_10 <dbl>, s_11 <dbl>,\n#   s_12 <dbl>, s_13 <dbl>, s_14 <dbl>, s_15 <dbl>, s_16 <dbl>, s_17 <int>,\n#   s_18 <int>, s_19 <dbl>, s_20 <dbl>, s_21 <dbl>, max_cycle <int>, RUL <int>,\n#   breakdown <dbl>, start <dbl>, s_9lag <dbl>\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1a$s_11lag = c(NA, data1a$s_11[-nrow(data1a)])\ndata1a$s_11lag[which(!duplicated(data1a$unit_nr))] = NA\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1a$s_4lag = c(NA, data1a$s_4[-nrow(data1a)])\ndata1a$s_4lag[which(!duplicated(data1a$unit_nr))] = NA\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1a$s_3lag = c(NA, data1a$s_3[-nrow(data1a)])\ndata1a$s_3lag[which(!duplicated(data1a$unit_nr))] = NA\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1a$s_17lag = c(NA, data1a$s_17[-nrow(data1a)])\ndata1a$s_17lag[which(!duplicated(data1a$unit_nr))] = NA\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncoxph(Surv(start, time_cycles, breakdown) ~ s_11lag + s_4lag + s_3lag + s_9lag + s_17lag, data = data1a)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\ncoxph(formula = Surv(start, time_cycles, breakdown) ~ s_11lag + \n    s_4lag + s_3lag + s_9lag + s_17lag, data = data1a)\n\n             coef exp(coef)  se(coef)     z        p\ns_11lag 8.318e+00 4.097e+03 1.064e+00 7.817 5.41e-15\ns_4lag  1.454e-01 1.156e+00 2.884e-02 5.040 4.64e-07\ns_3lag  7.274e-02 1.075e+00 2.988e-02 2.435   0.0149\ns_9lag  3.127e-03 1.003e+00 2.713e-03 1.153   0.2491\ns_17lag 2.633e-01 1.301e+00 1.233e-01 2.136   0.0327\n\nLikelihood ratio test=377.6  on 5 df, p=< 2.2e-16\nn= 20531, number of events= 100 \n   (100 observations deleted due to missingness)\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntab4 = matrix(c(7.404e-02, 1.077e+00, 0.0125, 1.562e-01, 1.169e+00, 3.22e-08, 4.999e-03, 1.005e+00, 0.0533, 8.460e+00, 4.722e+03, 2.76e-16), ncol = 3, byrow = TRUE)\ncolnames(tab4) = c(\"coef\", \"exp(coef)\", \"p-value\")\nrownames(tab4) = c('Sensor 3','Sensor 4','Sensor 9','Sensor 11')\ntab4 = as.table(tab4)\ntab4\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               coef exp(coef)   p-value\nSensor 3  7.404e-02 1.077e+00 1.250e-02\nSensor 4  1.562e-01 1.169e+00 3.220e-08\nSensor 9  4.999e-03 1.005e+00 5.330e-02\nSensor 11 8.460e+00 4.722e+03 2.760e-16\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntab5 = matrix(c(7.274e-02, 1.075e+00, 0.0149, 1.454e-01, 1.156e+00, 4.64e-07, 3.127e-03, 1.003e+00, 0.2491, 8.318e+00, 4.097e+03, 5.41e-15, 2.633e-01, 1.301e+00, 0.0327), ncol = 3, byrow = TRUE)\ncolnames(tab5) = c(\"coef\", \"exp(coef)\", \"p-value\")\nrownames(tab5) = c('Sensor 3','Sensor 4','Sensor 9','Sensor 11', 'Sensor 17')\ntab5 = as.table(tab5)\ntab5\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               coef exp(coef)   p-value\nSensor 3  7.274e-02 1.075e+00 1.490e-02\nSensor 4  1.454e-01 1.156e+00 4.640e-07\nSensor 9  3.127e-03 1.003e+00 2.491e-01\nSensor 11 8.318e+00 4.097e+03 5.410e-15\nSensor 17 2.633e-01 1.301e+00 3.270e-02\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1 %>% \n  ggplot(aes(x = time_cycles)) + \n  geom_point(aes(y = s_3)) +\n  xlim(c(0,375)) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Project_Final_Draft_files/figure-html/unnamed-chunk-39-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1 %>% \n  ggplot(aes(x = time_cycles)) + \n  geom_point(aes(y = s_4)) +\n  xlim(c(0,375)) +\n  theme_minimal() + \n  labs(title = \"Sensor 4 Readings over Time\", x = \"Time Cycles\", y = \"Sensor 4\")\n```\n\n::: {.cell-output-display}\n![](Project_Final_Draft_files/figure-html/unnamed-chunk-40-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1 %>% \n  ggplot(aes(x = time_cycles)) + \n  geom_point(aes(y = s_9)) +\n  xlim(c(0,375)) +\n  theme_minimal() + \n  labs(title = \"Sensor 9 Readings over Time\", x = \"Time Cycles\", y = \"Sensor 9\")\n```\n\n::: {.cell-output-display}\n![](Project_Final_Draft_files/figure-html/unnamed-chunk-41-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1 %>% \n  ggplot(aes(x = time_cycles)) + \n  geom_point(aes(y = s_11)) +\n  xlim(c(0,375)) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Project_Final_Draft_files/figure-html/unnamed-chunk-42-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1 %>% \n  ggplot(aes(x = time_cycles)) + \n  geom_point(aes(y = s_17)) +\n  xlim(c(0,375)) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Project_Final_Draft_files/figure-html/unnamed-chunk-43-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Project_Final_Draft_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}